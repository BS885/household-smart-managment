<div class="container">
    <h2>× ×™×”×•×œ ×”×¨×©××•×ª</h2>

    <div class="card">
        <div class="section-title">
            <span class="icon">+</span>
            ×”×•×¡×¤×ª ×”×¨×©××” ×—×“×©×”
        </div>
        <div class="form-group">
            <input type="text" placeholder="×©× ×”×¨×©××”" [(ngModel)]="newPermission.name" />
            <input type="text" placeholder="×ª×™××•×¨" [(ngModel)]="newPermission.description" />
            <button class="btn-add" (click)="addPermission()">
                <span class="icon">+</span>
                ×”×•×¡×£ ×”×¨×©××”
            </button>
        </div>
    </div>

    <div class="card">
        <div class="section-title">
            <span class="icon">â†”ï¸</span>
            ×©×™×•×š ×”×¨×©××” ×œ×ª×¤×§×™×“
        </div>
        <div class="form-group">
            <div class="select-wrapper">
                <select [(ngModel)]="roleName" class="role-select">
                    <option value="" disabled selected>×‘×—×¨ ×ª×¤×§×™×“</option>
                    <option value="admin">×× ×”×œ ××¢×¨×›×ª (Admin)</option>
                    <option value="user">××©×ª××© ×¨×’×™×œ (User)</option>
                    <option value="custom">×ª×¤×§×™×“ ××•×ª×× ××™×©×™×ª</option>
                </select>
            </div>
            @if (roleName === 'custom') {
            <input type="text" placeholder="×©× ×ª×¤×§×™×“ ××•×ª××" [(ngModel)]="customRoleName" />
            }
            <input type="text" placeholder="×‘×—×¨ ×”×¨×©××”" [(ngModel)]="permissionName" class="permission-input" />

            <button class="btn-assign" (click)="assignPermissionToRole()">
                <span class="icon">â†”ï¸</span>
                ×©×™×™×š ×”×¨×©××” ×œ×ª×¤×§×™×“
            </button>
        </div>
    </div>

    <div class="permission-list">
        @if ((permission$ | async)?.length) {
        @for(permission of permission$ | async; track permission.id) {
        <div class="permission-item" (click)="selectPermission(permission.name)">
            <div class="permission-content">
                <div class="permission-name">{{ permission.name }}</div>
                <div class="permission-description">{{ permission.description }}</div>
                @if(permission.roleNames?.length) {
                <div class="permission-roles">
                    @for(role of permission.roleNames; track role.roleName) {
                    <div class="role-item">
                        {{ role.roleName }}
                    </div>
                    }
                </div>
                }
            </div>
            <div class="permission-actions">
                <button class="btn-delete" (click)="$event.stopPropagation(); deletePermission(permission.id)"
                    title="××—×§ ×”×¨×©××”">
                    <span class="icon">ğŸ—‘ï¸</span>
                </button>
            </div>
        </div>
        }
        } @else {
        <div class="empty-state">
            ×œ× × ××¦××• ×”×¨×©××•×ª ×‘××¢×¨×›×ª. ×× × ×”×•×¡×£ ×”×¨×©××” ×—×“×©×”.
        </div>
        }
    </div>
</div>